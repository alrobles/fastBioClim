% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/parallel_which_max_quarter.R
\name{parallel_which_max_quarter}
\alias{parallel_which_max_quarter}
\title{Rolling quarter (3-month) maximum index per row (parallel)}
\usage{
parallel_which_max_quarter(mat, wrap = FALSE, na_rm = FALSE)
}
\arguments{
\item{mat}{Numeric matrix (rows = cells, columns = months). Must have
at least 3 columns.}

\item{wrap}{Logical; if \code{TRUE}, allow wrap-around windows (e.g., Dec–Jan–Feb).
If \code{FALSE}, only windows \verb{[1..3], [2..4], ..., [10..12]} are considered.}

\item{na_rm}{Logical; see details above.}
}
\value{
An integer vector of length \code{nrow(mat)} with \strong{1-based} starting
indices. Row names are preserved from \code{mat} if present.
}
\description{
Returns, for each row, the \strong{starting column index} (1-based) of the
3-consecutive-month window whose \strong{score is maximum}.
The score is a 3-month \strong{mean}:
\itemize{
\item If \code{na_rm = FALSE} (default), any \code{NA} in a window \strong{invalidates} that window.
\item If \code{na_rm = TRUE}, the score is computed as the \strong{mean over non-NA values};
windows with \strong{all NA} are invalid. If \strong{no valid windows} exist for a row,
the result is \code{NA}.
}
}
