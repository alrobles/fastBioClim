% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/parallel_variance.R
\name{parallel_variance}
\alias{parallel_variance}
\title{Row-wise sample variance (parallel)}
\usage{
parallel_variance(mat)
}
\arguments{
\item{mat}{A \strong{numeric matrix} (rows = units such as grid cells;
columns = measurements, e.g., 12 monthly values).}
}
\value{
A \strong{numeric vector} of length \code{nrow(mat)} with the
\strong{row-wise sample variance} (denominator \eqn{n-1}). Row names are preserved
(if present).
}
\description{
Fast row-wise \strong{sample variance} using a parallel C++ implementation
(Welford one-pass update via \pkg{RcppParallel}). This is especially useful
for large rasters represented as matrices of size \eqn{n_{\text{cells}}
\times 12} (months), e.g., when computing bioclimatic variables from
CHELSA/WorldClim monthly climatologies.
}
\details{
Typical uses include intermediate steps in \strong{CHELSA Bioclim} calculations,
such as computing monthly temperature/precipitation dispersion metrics. For
example, CHELSA \strong{BIO4 (Temperature Seasonality)} uses the standard
deviation of monthly mean temperature scaled by 100; this function provides
the row-wise variance part of that workflow (see also \code{\link[=parallel_sd]{parallel_sd()}}).

References:
\itemize{
\item CHELSA Bioclim dataset:
\url{https://www.chelsa-climate.org/datasets/chelsa_bioclim}
\item Karger et al. (2022). CHELSA V2.1: High-resolution monthly and annual
climatologies for the Earth land surface areas. \emph{Earth Syst. Sci. Data},
14, 5573â€“5610.
}
}
\section{NA handling}{

If any \code{NA}/\code{NaN} is present in a row, the result for that row is \code{NA}
(mirrors base R with \code{na.rm = FALSE}). Rows with fewer than 2 columns also
yield \code{NA}.
}

\examples{
set.seed(1)
mat <- matrix(rnorm(5 * 12, 15, 6),
  nrow = 5, ncol = 12,
  dimnames = list(paste0("cell", 1:5), month.abb)
)
v_par <- parallel_variance(mat)
v_ref <- apply(mat, 1, var)
all.equal(v_par, v_ref)

# Example of use in a CHELSA-style workflow (variance part)
# (BIO4 uses SD * 100; see parallel_sd())
}
\seealso{
\code{\link[=parallel_sd]{parallel_sd()}}
}
