% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bio_08.R
\name{bio_08}
\alias{bio_08}
\title{bio_08  Mean Temperature of Wettest Quarter (BIO8)}
\usage{
bio_08(pr, tas, wrap = FALSE, na_rm = FALSE, filename = "")
}
\arguments{
\item{pr}{A \link[terra:SpatRaster-class]{terra::SpatRaster} with \strong{12 layers} representing monthly
total precipitation.}

\item{tas}{A \link[terra:SpatRaster-class]{terra::SpatRaster} with \strong{12 layers} representing monthly
mean temperature.}

\item{wrap}{Logical; if \code{TRUE}, allow wrap‑around rolling quarters
(e.g., Dec–Jan–Feb). If \code{FALSE} (default), only non‑wrapping windows
\code{[1..3], [2..4], ..., [10..12]} are considered.}

\item{filename}{Optional file path to write the output raster
("" for in‑memory).}
}
\value{
A \link[terra:SpatRaster-class]{terra::SpatRaster} with one layer representing \strong{BIO8}
(Mean Temperature of Wettest Quarter, units °C).
}
\description{
Computes \strong{BIO8 (Mean Temperature of Wettest Quarter)} from monthly
precipitation (\code{pr}) and monthly mean temperature (\code{tas}) rasters following
the CHELSA/WorldClim Bioclimatic Variables framework.
}
\details{
BIO8 is defined as the \strong{average monthly mean temperature over the wettest
3‑month period} of the year, computed per cell. This implementation:
\enumerate{
\item Finds, for each cell, the starting month of the \strong{wettest quarter}
by taking rolling 3‑month precipitation sums (optionally with
wrap‑around windows, e.g. Dec–Jan–Feb when \code{wrap = TRUE}).
\item Uses that quarter index to compute the \strong{mean of the three monthly
mean temperatures} from \code{tas} for the same months.
}

The rolling quarter index is obtained with
\code{parallel_which_max_quarter(pr_matrix, wrap = ...)}, and the
quarter mean temperature is computed with
\code{get_average_quarter(idx, tas_matrix)} which averages
over the three months (skipping \code{NA}s among those three values; all
\code{NA} in the window yields \code{NA}).
}
\section{Inputs and units}{

\itemize{
\item \code{pr}: monthly total precipitation (e.g., mm), 12 layers (Jan–Dec).
\item \code{tas}: monthly mean temperature (°C), 12 layers (Jan–Dec).
Both rasters must have identical spatial geometry (extent, resolution, CRS)
and the same number of rows/columns.
}
}

\examples{
# Example (with mock data generators)
pr_ex <- mock_pr() # 12-layer monthly precipitation (mm)
tas_ex <- mock_tas() # 12-layer monthly mean temperature (°C)

}
\references{
Karger, D.N., et al. (2022). CHELSA V2.1: High‑resolution monthly and annual
climatologies for the Earth land surface areas. \emph{Earth System Science Data},
14, 5573–5610.
Hijmans, R.J., et al. (2005). Very high resolution interpolated climate
surfaces for global land areas. \emph{International Journal of Climatology},
25(15), 1965–1978.
See also CHELSA Bioclim dataset overview:
\url{https://www.chelsa-climate.org/datasets/chelsa_bioclim}
}
